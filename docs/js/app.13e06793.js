(function(e){function t(t){for(var a,s,o=t[0],u=t[1],c=t[2],h=0,p=[];h<o.length;h++)s=o[h],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&p.push(i[s][0]),i[s]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(e[a]=u[a]);l&&l(t);while(p.length)p.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,o=1;o<n.length;o++){var u=n[o];0!==i[u]&&(a=!1)}a&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},i={app:0},r=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var l=u;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"278d":function(e,t,n){"use strict";var a=n("a5ac"),i=n.n(a);i.a},"4e95":function(e,t,n){},"5c0b":function(e,t,n){"use strict";var a=n("e332"),i=n.n(a);i.a},"8b4d":function(e,t,n){},a5ac:function(e,t,n){},a932:function(e,t,n){"use strict";var a=n("4e95"),i=n.n(a);i.a},cd49:function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Map",{attrs:{restaurants:e.restaurantList}})],1)},r=[],s=(n("ac6a"),n("d225")),o=n("b0b4"),u=n("308d"),c=n("6bb5"),l=n("4e2b"),h=n("9ab4"),p=n("60a3"),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"map"},[n("LMap",{staticStyle:{height:"100%",width:"100%"},attrs:{zoom:e.zoom,center:e.center},on:{"update:zoom":e.zoomUpdated,"update:center":e.centerUpdated,"update:bounds":e.boundsUpdated}},[n("LTileLayer",{attrs:{url:e.url}}),e._l(e.restaurantList,function(e){return n("RestaurantMarker",{key:e.title,attrs:{restaurant:e}})})],2)],1)},f=[],v=n("e11e"),m=n("2699"),b=n("a40a"),_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("LMarker",{attrs:{"lat-lng":e.convertLatLng(e.restaurant.location)},on:{click:e.clickHandler}},[n("l-popup",[n("Popup",{attrs:{restaurant:e.restaurant,loadMenu:e.loadMenu}})],1)],1)],1)},y=[],g=n("4e2b6"),O=n("f60f"),k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"popup"},[n("div",{staticClass:"popup__label"},[e._v(e._s(e.title))]),n("div",{staticClass:"popup__label"},[e._v("Osoite: "+e._s(e.restaurant.address))]),e.hasTime?n("div",{staticClass:"popup__label"},[e._v("Lounasaika: "+e._s(e.lunchTime))]):n("div",{staticClass:"popup__label"},[e._v("Lounasaika: Ei lounasaikaa saatavilla")]),e.hasMenu?n("div",{staticClass:"popup__menu"},[e._m(0),e._l(e.lunchMenu,function(t){return n("div",{key:t.Name,staticClass:"popup__menu__item"},[n("div",{staticClass:"popup__menu__item__title"},[e._v(e._s(t.Name))]),n("div",{staticClass:"popup__menu__item__ingredients"},[n("Incredient",{attrs:{item:t}})],1),n("div",{staticClass:"popup__menu__item__price"},[e._v(e._s(t.Price))])])})],2):n("div",[n("div",{staticClass:"popup__label"},[e._v("Ei ruokalistaa saatavilla")])]),e.isLoading?n("div",{staticClass:"popup__loading"},[n("i",{staticClass:"fa fa-spinner fa-spin"})]):e._e()])},j=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"popup__menu__item__labels"},[n("div",{},[e._v("Nimi")]),n("div",{},[e._v("Ainekset")]),n("div",{},[e._v("Hinta")])])}],w=(n("7f7f"),n("6762"),n("2fdb"),n("28a5"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"incredient"},[n("div",{staticClass:"incredient__container",class:{expanded:e.showFullIncredients}},e._l(e.item.Components,function(t){return n("div",{key:t,staticClass:"incredient__ingredients__item",domProps:{innerHTML:e._s(t)}})}),0),e.showFullIncredients?n("div",{staticClass:"incredient__container__button",on:{click:function(t){e.showFullIncredients=!e.showFullIncredients}}},[e._v("\n      Näytä vähemmän\n  ")]):n("div",{staticClass:"incredient__container__button",on:{click:function(t){e.showFullIncredients=!e.showFullIncredients}}},[e._v("\n      Näytä enemmän\n  ")])])}),M=[],C=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.showFullIncredients=!1,e}return Object(l["a"])(t,e),t}(p["c"]);Object(h["a"])([Object(p["b"])()],C.prototype,"item",void 0),C=Object(h["a"])([p["a"]],C);var T=C,D=T,I=(n("e642"),n("2877")),P=Object(I["a"])(D,w,M,!1,null,"e517d704",null),x=P.exports,U=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.lunchMenu=[],e.lunchTime="",e.title=e.restaurant.title,e.hasMenu=!0,e.hasTime=!0,e.isLoading=!0,e}return Object(l["a"])(t,e),Object(o["a"])(t,[{key:"fetchLuchMenu",value:function(e){return fetch("https://akalhainen.me/"+e).then(function(e){return e.json()},function(e){console.error(e)})}},{key:"getDate",value:function(e,t,n){var a=t.toLowerCase(),i=a.split(n),r=e.split(n),s=i.indexOf("mm"),o=i.indexOf("dd"),u=i.indexOf("yyyy"),c=parseInt(r[s]);c-=1;var l=new Date(parseInt(r[u]),c,parseInt(r[o]));return l}},{key:"parseFazer",value:function(e){e.MenusForDays||(this.hasMenu=!1,this.hasTime=!1);var t=e.MenusForDays.filter(function(e){return new Date(e.Date).getDate()===(new Date).getDate()})[0];this.lunchMenu=t.SetMenus,this.title=e.RestaurantName,this.lunchTime=t.LunchTime,this.lunchMenu.length<1&&(this.hasMenu=!1,this.hasTime=!1)}},{key:"parseUnicafe",value:function(e){var t=this,n=e.filter(function(e){return t.title.toLowerCase().includes(e.menuData.name.toLowerCase())})[0];if(!n)return this.hasMenu=!1,void(this.hasTime=!1);var a=(new Date).getFullYear(),i=n.menuData.menus.filter(function(e){var n=e.date.split(" ")[1]+a,i=t.getDate(n,"dd.mm.yyyy",".");return i.getDate()===(new Date).getDate()})[0].data;this.title=n.title;var r=n.menuData.visitingHours.lounas.items;(new Date).getDay();r?this.lunchTime=r[0].label+" "+r[0].hours+", "+r[1].label+" "+r[1].hours:(this.lunchTime="",this.hasMenu=!1,this.hasTime=!1);var s=[];i.forEach(function(e){var t={Price:"",Components:[""],Name:""};t.Components=[e.ingredients],t.Price="Opiskelija: "+e.price.value.student,t.Name=e.name,s.push(t)}),this.lunchMenu=s,this.lunchMenu.length<1&&(this.hasMenu=!1)}},{key:"parseSodexo",value:function(e){e.menus||(this.hasMenu=!1,this.hasTime=!1);var t=["saturday","sunday","monday","tuesday","wednesday","thursday","friday"],n=t[(new Date).getDay()],a=[];e.menus[n]&&(e.menus[n].forEach(function(e){var t={Price:"",Components:[""],Name:""};t.Components=[e.properties],t.Price=e.price,t.Name=e.title_fi,a.push(t)}),this.lunchMenu=a,this.title=e.meta.ref_title,this.lunchTime="",this.hasTime=!1),this.lunchMenu.length<1&&(this.hasMenu=!1,this.hasTime=!1)}},{key:"parseJuvenes",value:function(e){var t=this;e.MealOptions||(this.hasMenu=!1,this.hasTime=!1),fetch(this.restaurant.website).then(function(e){return e.json()},function(e){console.error(e)}).then(function(n){var a=["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],i=a[(new Date).getDay()],r=[];e.MealOptions.forEach(function(e){var t={Price:"",Components:[""],Name:""};t.Components=[e.MenuItems[0].Ingredients],t.Price="",t.Name=e.Name_FI,r.push(t)}),t.lunchMenu=r,t.title=e.KitchenName;var s="".concat(i,"Start"),o="".concat(i,"End");t.lunchTime=n.d.OpenInfo[s]+" - "+n.d.OpenInfo[o],t.lunchMenu.length<1&&(t.hasMenu=!1,t.hasTime=!1)})}}]),t}(p["c"]);Object(h["a"])([Object(p["b"])()],U.prototype,"restaurant",void 0),Object(h["a"])([Object(p["b"])()],U.prototype,"loadMenu",void 0),U=Object(h["a"])([Object(p["a"])({components:{Incredient:x},watch:{loadMenu:function(e,t){var n=this;!t&&e&&(console.log(this.restaurant.lunchUrl),this.restaurant.lunchUrl?this.fetchLuchMenu(this.restaurant.lunchUrl).then(function(e){switch(n.isLoading=!1,n.restaurant.type){case"fazer":n.parseFazer(e);break;case"unicafe":n.parseUnicafe(e);break;case"sodexo":n.parseSodexo(e);break;case"juvenes":n.parseJuvenes(e);break}}):(this.isLoading=!1,this.hasMenu=!1,this.hasTime=!1))}}})],U);var N=U,F=N,E=(n("278d"),Object(I["a"])(F,k,j,!1,null,"3b1eed08",null)),S=E.exports,z=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.loadMenu=!1,e}return Object(l["a"])(t,e),Object(o["a"])(t,[{key:"mounted",value:function(){}},{key:"clickHandler",value:function(){this.loadMenu=!0}},{key:"convertLatLng",value:function(e){return Object(v["latLng"])(e.lat,e.lng)}}]),t}(p["c"]);Object(h["a"])([Object(p["b"])()],z.prototype,"restaurant",void 0),z=Object(h["a"])([Object(p["a"])({components:{LMarker:g["a"],LPopup:O["a"],Popup:S}})],z);var A=z,R=A,$=Object(I["a"])(R,_,y,!1,null,"c8c8ad5a",null),H=$.exports,J=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.url="https://api.tiles.mapbox.com/v4/mapbox.streets/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw",e.zoom=14,e.center=[60.167255,24.940523],e.bounds=null,e.showParagraph=!1,e}return Object(l["a"])(t,e),Object(o["a"])(t,[{key:"mounted",value:function(){delete v["Icon"].Default.prototype._getIconUrl,v["Icon"].Default.imagePath="/",v["Icon"].Default.mergeOptions({iconRetinaUrl:n("584d"),iconUrl:n("6397"),shadowUrl:n("e2b9")}),navigator.geolocation&&navigator.geolocation.getCurrentPosition(this.setPosition)}},{key:"setPosition",value:function(e){this.center=[e.coords.latitude,e.coords.longitude],this.zoom=14}},{key:"restaurantList",get:function(){var e=this.restaurants.filter(function(e){return null!==e.location});return e}}]),t}(p["c"]);Object(h["a"])([Object(p["b"])()],J.prototype,"restaurants",void 0),J=Object(h["a"])([Object(p["a"])({components:{LMap:m["a"],LTileLayer:b["a"],RestaurantMarker:H},methods:{zoomUpdated:function(e){this.zoom=e},centerUpdated:function(e){this.center=e},boundsUpdated:function(e){this.bounds=e}}})],J);var Y=J,B=Y,q=(n("a932"),Object(I["a"])(B,d,f,!1,null,"a941f7be",null)),W=q.exports,X=function(){function e(t,n,a,i,r,o){if(Object(s["a"])(this,e),this._title=t,this._address=n,this._location=a,this._website=i,this._type=r,this._lunchUrl=o,this.location){this._marker=L.marker([+this.location.lat,+this.location.lng]);var u=this.website?"<p>"+this.title+'</p><br><a href="'+this.website+'">Ruokalista</a>':"<p>"+this.title+"</p>";this._marker.bindPopup(u)}}return Object(o["a"])(e,[{key:"addMarkerToMap",value:function(e){this._marker&&(this._map=e,this._marker.addTo(e))}},{key:"hideMarker",value:function(){this._marker&&this._marker.remove()}},{key:"showMarker",value:function(){(this._map||this._marker)&&this._marker.addTo(this._map)}},{key:"title",get:function(){return this._title}},{key:"type",get:function(){return this._type}},{key:"address",get:function(){return this._address}},{key:"location",get:function(){return this._location}},{key:"website",get:function(){return this._website}},{key:"lunchUrl",get:function(){return this._lunchUrl}}]),e}(),G=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.restaurantList=[],e.timeout=0,e}return Object(l["a"])(t,e),Object(o["a"])(t,[{key:"getRestaurants",value:function(){return fetch("https://akalhainen.me/ruokalistat/restaurants.json").then(function(e){return e.json()})}},{key:"created",value:function(){var e=this;this.getRestaurants().then(function(t){t.forEach(function(t){var n=new X(t.title,t.address,t.location,t.website,t.type,t.lunchUrl);e.restaurantList.push(n)})}),document.addEventListener("swUpdated",this.updateApp,{once:!0})}},{key:"updateApp",value:function(e){console.log("Deploying update.."),window.location.reload(!0)}}]),t}(p["c"]);G=Object(h["a"])([Object(p["a"])({components:{Map:W},data:function(){return{}}})],G);var K=G,Q=K,V=(n("5c0b"),Object(I["a"])(Q,i,r,!1,null,null,null)),Z=V.exports,ee=n("2f62");a["default"].use(ee["a"]);var te=new ee["a"].Store({state:{unicafeMenu:void 0},mutations:{unicafeMenu:function(e,t){e.unicafeMenu=t}},getters:{unicafeMenu:function(e){return e.unicafeMenu}},actions:{}}),ne=n("9483");Object(ne["a"])("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(e){document.dispatchEvent(new CustomEvent("swUpdated",{detail:e})),console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var ae=n("ce5b"),ie=n.n(ae);a["default"].use(ie.a),a["default"].config.productionTip=!1,new a["default"]({store:te,render:function(e){return e(Z)}}).$mount("#app")},e332:function(e,t,n){},e642:function(e,t,n){"use strict";var a=n("8b4d"),i=n.n(a);i.a}});
//# sourceMappingURL=app.13e06793.js.map